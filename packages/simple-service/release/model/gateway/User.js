"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.initialize=void 0;const core_1=require("@sequelize/core"),lib_1=__importDefault(require("../../lib")),hashPassword=async e=>{(e.isNewRecord||e.changed("password"))&&(e.password=await lib_1.default.password.hashPassword(e.password))};class User extends core_1.Model{}User.associate=e=>{User.hasOne(e.UserProfile,{foreignKey:"user_id",constraints:!1}),User.hasMany(e.UserToken,{foreignKey:"user_id",constraints:!1}),User.hasMany(e.RbacUserRole,{foreignKey:"user_id",constraints:!1})};const initialize=e=>(User.init({id:{type:core_1.DataTypes.INTEGER,primaryKey:!0,autoIncrement:!0},email:core_1.DataTypes.STRING,password:core_1.DataTypes.STRING,reset_password_token:core_1.DataTypes.STRING,reset_password_sent_at:core_1.DataTypes.DATE,confirmation_token:core_1.DataTypes.STRING,confirmed_at:core_1.DataTypes.DATE,confirmation_sent_at:core_1.DataTypes.DATE,unconfirmed_email:core_1.DataTypes.STRING,latest_sign_in_token:core_1.DataTypes.STRING,sign_in_count:core_1.DataTypes.INTEGER,current_sign_in_at:core_1.DataTypes.DATE,last_sign_in_at:core_1.DataTypes.DATE,current_sign_in_ip:core_1.DataTypes.STRING,last_sign_in_ip:core_1.DataTypes.STRING,failed_attempts:core_1.DataTypes.INTEGER,locked_at:core_1.DataTypes.DATE,unlock_token:core_1.DataTypes.STRING,last_change_pass_at:core_1.DataTypes.DATE,enabled:core_1.DataTypes.BOOLEAN,created_at:core_1.DataTypes.DATE,updated_at:core_1.DataTypes.DATE},{sequelize:e,tableName:"users",modelName:"User",timestamps:!1,hooks:{beforeCreate:hashPassword,beforeUpdate:hashPassword}}),User);exports.initialize=initialize,exports.default=User;