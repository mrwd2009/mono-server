"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.randomPassword=exports.charsInRange=exports.shuffleArray=exports.isPasswordEqual=exports.hashPassword=void 0;const bcryptjs_1=require("bcryptjs"),zxcvbn_1=__importDefault(require("zxcvbn")),config_1=__importDefault(require("../../config/config")),hashPassword=async t=>{const e=await(0,bcryptjs_1.genSalt)(10);return await(0,bcryptjs_1.hash)(t,e)};exports.hashPassword=hashPassword;const isPasswordEqual=async(t,e)=>await(0,bcryptjs_1.compare)(t,e);exports.isPasswordEqual=isPasswordEqual;const shuffleArray=t=>{let e=t.length,s=null,o=0;for(;e;)o=Math.floor(Math.random()*e),e-=1,s=t[e],t[e]=t[o],t[o]=s;return t};exports.shuffleArray=shuffleArray;const charsInRange=(t,e)=>{let s=t.charCodeAt(0);const o=e.charCodeAt(0),n=[];for(;s<=o;)n.push(String.fromCharCode(s)),s+=1;return n};exports.charsInRange=charsInRange;const randomPassword=()=>{const t=(0,exports.charsInRange)("A","Z"),e=(0,exports.charsInRange)("a","z"),s=(0,exports.charsInRange)("0","9"),o="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~".split(""),n=t.concat(e,s,o),r=(h,u)=>{const d=[];for(;u>0;)d.push(h[Math.floor(Math.random()*h.length)]),u-=1;return d},p=11+Math.floor(Math.random()*5),c=()=>(0,exports.shuffleArray)(r(t,1).concat(r(e,1),r(s,1),r(o,1),r(n,p-4))).join("");let a=c(),l=0;const{score:i,randomPasswordLoop:x}=config_1.default.auth.zxcvbn;for(;(0,zxcvbn_1.default)(a).score<i&&l<x;)a=c(),l++;return a};exports.randomPassword=randomPassword;