"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fullFormats=exports.errorReponse=void 0;const winston_1=require("winston"),lodash_1=require("lodash"),safe_stable_stringify_1=__importDefault(require("safe-stable-stringify")),query_string_1=__importDefault(require("query-string")),{timestamp,combine,json}=winston_1.format;exports.errorReponse=(0,winston_1.format)(e=>{const{query:r,body:t,stack:a,...s}=e.response||{};if(e.query=r&&query_string_1.default.stringify(r)||"",e.body=t&&(0,safe_stable_stringify_1.default)(t)||"",e.stack=a||"",e.remainedInfo=!(0,lodash_1.isEmpty)(s)&&(0,safe_stable_stringify_1.default)(s)||"",e.durationMs=e.durationMs||-1,e.trackId=e.trackId||"",e.logUser=e.user||"ananymity",e.exception){e.stack=e.message,e.message="$exception";const u={error:e.error,os:e.os,process:e.process,trace:e.trace};e.remainedInfo=(0,safe_stable_stringify_1.default)(u),delete e.error,delete e.os,delete e.process,delete e.trace,delete e.date}else e.exception=!1;return delete e.response,delete e.user,e}),exports.fullFormats=combine(timestamp(),(0,exports.errorReponse)(),json());