"use strict";var __importDefault=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.pureLogger=void 0;const cluster_1=__importDefault(require("cluster")),winston_1=require("winston"),log_transport_1=require("./log-transport"),log_format_1=require("./log-format"),handler_1=require("../signal/handler"),baseOpts={transports:(0,log_transport_1.getPrimaryTransports)()},logger=(0,winston_1.createLogger)({...baseOpts,format:log_format_1.fullFormats,exceptionHandlers:(0,log_transport_1.getExceptionTransports)(),exitOnError:!0});exports.pureLogger=(0,winston_1.createLogger)(baseOpts),(0,handler_1.registerCleanupHandler)(async()=>{logger.close(),exports.pureLogger.close()}),cluster_1.default.on("message",(r,e)=>{e&&e.type==="log"&&exports.pureLogger.log(e.payload)}),exports.default=logger;