"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLogListHandler=exports.getAgentListHandler=exports.createAgentHandler=exports.assignAgentHandler=exports.getServiceAgentListHandler=exports.getServiceListHandler=exports.createServiceHandler=void 0;const middleware_1=require("../../../middleware"),model_1=require("../model");exports.createServiceHandler=[(0,middleware_1.validator)(e=>e.object({name:e.string(),category:e.string(),description:e.string(),command:e.string()})),async e=>{e.gateway?.sendJSON?.(await model_1.deploymentModel.createService(e.mergedParams))}],exports.getServiceListHandler=[(0,middleware_1.validatePagination)(),async e=>{const t=await model_1.deploymentModel.getServiceList(e.mergedParams);e.gateway?.sendJSON?.(t)}],exports.getServiceAgentListHandler=[(0,middleware_1.validatePagination)(),async e=>{const t=await model_1.deploymentModel.getServiceAgentList(e.mergedParams);e.gateway?.sendJSON?.(t)}],exports.assignAgentHandler=[(0,middleware_1.validator)(e=>e.object({serviceId:e.number().integer(),agentIds:e.array().items(e.number().integer()),action:e.string().valid("add","remove")})),async e=>{const t=await model_1.deploymentModel.assignAgent(e.mergedParams);e.gateway?.sendJSON?.(t)}],exports.createAgentHandler=[(0,middleware_1.validator)(e=>e.object({name:e.string(),ip:e.string().ip({version:["ipv4"]})})),async e=>{e.gateway?.sendJSON?.(await model_1.deploymentModel.createAgent(e.mergedParams))}],exports.getAgentListHandler=[(0,middleware_1.validatePagination)(),async e=>{e.gateway?.sendJSON?.(await model_1.deploymentModel.getAgentList(e.mergedParams))}],exports.getLogListHandler=[(0,middleware_1.validatePagination)(),async e=>{e.gateway?.sendJSON?.(await model_1.deploymentModel.getLogList(e.mergedParams))}];