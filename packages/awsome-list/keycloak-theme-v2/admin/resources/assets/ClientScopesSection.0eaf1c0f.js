import{l as Y,u as q,ay as G,az as J,r as c,ae as Q,aY as P,h as F,F as k,j as t,b2 as X,P as Z,s as _,b4 as A,bL as $,an as ee,am as te,ap as oe,bD as L,bK as ne}from"./index.0cb2e516.js";import{V as ae}from"./ViewHeader.2586557f.js";import{K as se}from"./KeycloakDataTable.4e517788.js";import{u as re}from"./ConfirmDialog.f8013bbb.js";import{u as ce,m as le}from"./useLocaleSort.84ea7ec0.js";import{A as p,r as ie,C as R,d as pe,b as me}from"./ClientScopeTypes.9d1fc6d4.js";import{S as de,a as Se,C as ue,n as ye,t as he,p as fe}from"./SearchFilter.f13d0406.js";import{g as ge}from"./utils.988d95db.js";import{c as h}from"./HelpItem.e440d5db.js";import{ah as B}from"./TableToolbar.c27bcd3c.js";import"./Text.c38ffb52.js";import"./plus-circle-icon.32cdf4dc.js";import"./EmptyStateBody.a0363fe4.js";import"./EmptyStateSecondaryActions.1a804d56.js";import"./Modal.6593dfcc.js";import"./Select.5a6b39aa.js";import"./FormGroup.3d5f3f16.js";import"./check.51c67984.js";import"./star-icon.97692015.js";import"./filter-icon.fec9f70e.js";import"./grip-vertical-icon.1b75ab8f.js";import"./Checkbox.2dc73ed3.js";function He(){const{realm:f}=Y(),{t:n}=q("client-scopes"),{adminClient:a}=G(),{addAlert:g,addError:b}=J(),[N,C]=c.exports.useState(!1),[l,m]=c.exports.useState([]),[s,w]=c.exports.useState("name"),[T,d]=c.exports.useState(p.none),[K,S]=c.exports.useState("all"),O=ce(),[D,V]=c.exports.useState(0),r=()=>{m([]),V(D+1)},v=async(e,o,i)=>{const U=await a.clientScopes.listDefaultClientScopes(),z=await a.clientScopes.listDefaultOptionalClientScopes(),H=await a.clientScopes.find(),M=s==="name"?ye(i):s==="type"?he(T):fe(K),W=H.map(u=>({...u,type:U.find(y=>y.name===u.name)?R.default:z.find(y=>y.name===u.name)?R.optional:p.none})).filter(M);return O(W,le("name")).slice(e,Number(e)+Number(o))},[x,E]=re({titleKey:n("deleteClientScope",{count:l.length,name:l[0]?.name}),messageKey:"client-scopes:deleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:Q.danger,onConfirm:async()=>{try{for(const e of l){try{await ie(a,e)}catch(o){console.warn("could not remove scope",o.response?.data?.errorMessage||o)}await a.clientScopes.del({id:e.id})}g(n("deletedSuccess"),P.success),r()}catch(e){b("client-scopes:deleteError",e)}}}),I=e=>t(pe,{clientScope:e,type:e.type,all:!0,onSelect:async o=>{try{await me(a,e,o),g(n("clientScopeSuccess"),P.success),r()}catch(i){b("client-scopes:clientScopeError",i)}}}),j=({id:e,type:o,name:i})=>t(A,{to:ne({realm:f,id:e,type:o,tab:"settings"}),children:i},e);return F(k,{children:[t(E,{}),t(ae,{titleKey:"clientScopes",subKey:"client-scopes:clientScopeExplain",helpUrl:X.clientScopesUrl}),t(Z,{variant:"light",className:"pf-u-p-0",children:t(se,{loader:v,ariaLabelKey:"client-scopes:clientScopeList",searchPlaceholderKey:s==="name"?"client-scopes:searchFor":void 0,isSearching:s!=="name",searchTypeComponent:t(de,{searchType:s,onSelect:e=>w(e),withProtocol:!0}),isPaginated:!0,onSelect:e=>m([...e]),canSelectAll:!0,toolbarItem:F(k,{children:[t(Se,{searchType:s,type:T,onSelect:e=>{w(e),S("all"),d(p.none),r()},onType:e=>{d(e),S("all"),r()},protocol:K,onProtocol:e=>{S(e),d(p.none),r()}}),t(h,{children:t(_,{component:e=>t(A,{...e,to:$({realm:f})}),children:n("createClientScope")})}),t(h,{children:t(ue,{selectedRows:l,refresh:r})}),t(h,{children:t(ee,{toggle:t(te,{onToggle:C}),isOpen:N,isPlain:!0,dropdownItems:[t(oe,{component:"button",isDisabled:l.length===0,onClick:()=>{x(),C(!1)},children:n("common:delete")},"action")]})})]}),actions:[{title:n("common:delete"),onRowClick:e=>{m([e]),x()}}],columns:[{name:"name",cellRenderer:j},{name:"type",displayKey:"client-scopes:assignedType",cellRenderer:I},{name:"protocol",displayKey:"client-scopes:protocol",cellRenderer:e=>ge(n,e.protocol??"openid-connect"),transforms:[B(15)]},{name:"attributes['gui.order']",displayKey:"client-scopes:displayOrder",cellFormatters:[L()],transforms:[B(15)]},{name:"description",cellFormatters:[L()]}]},D)})]})}export{He as default};
