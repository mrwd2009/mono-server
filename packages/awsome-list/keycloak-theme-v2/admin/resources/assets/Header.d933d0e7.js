import{T as M,H as y}from"./HelpItem.e440d5db.js";import{b as O,C as p,a as w}from"./index.esm.6af887f8.js";import{F as $}from"./FormAccess.bee4f1e0.js";import{h as u,F as b,j as e,T as K,u as H,bA as z,aw as W,ay as q,az as U,l as Y,ae as B,aY as R,cI as j,ap as X}from"./index.0cb2e516.js";import{T as G}from"./Text.c38ffb52.js";import{u as L}from"./useToggle.8c992bea.js";import{i as x}from"./isEqual.b67f23a3.js";import{a as I}from"./FormGroup.3d5f3f16.js";import{S as V,b as _,a as n}from"./Select.5a6b39aa.js";import{N as J}from"./NumberInput.331c7b85.js";import{u as P}from"./ConfirmDialog.f8013bbb.js";import{V as k}from"./ViewHeader.2586557f.js";const Q=({title:o,description:t,showDescription:r=!1})=>u(b,{children:[e(M,{size:"xl",headingLevel:"h2",className:r?"kc-wizard-section-header__title--has-description":"kc-wizard-section-header__title",children:o}),r&&e(K,{className:"kc-wizard-section-header__description",children:e(G,{children:t})})]}),N=({form:o})=>{const{t}=H("user-federation"),[r,m]=L(),[s,d]=L(),[S,T]=L(),[F,E]=L(),h=O({control:o.control,name:"config.cachePolicy"}),D=[e(n,{value:[`${0}`],isPlaceholder:!0,children:[`0${0}`]},0)];let g="";for(let i=1;i<24;i++)i<10?g=`0${i}`:g=`${i}`,D.push(e(n,{value:[`${i}`],children:g},i));const C=[e(n,{value:[`${0}`],isPlaceholder:!0,children:[`0${0}`]},0)];let v="";for(let i=1;i<60;i++)i<10?v=`0${i}`:v=`${i}`,C.push(e(n,{value:[`${i}`],children:v},i));return u(b,{children:[e(I,{label:t("cachePolicy"),labelIcon:e(y,{helpText:"user-federation-help:cachePolicyHelp",fieldLabelId:"user-federation:cachePolicy"}),fieldId:"kc-cache-policy",children:e(p,{name:"config.cachePolicy",defaultValue:["DEFAULT"],control:o.control,render:({onChange:i,value:a})=>u(V,{toggleId:"kc-cache-policy",required:!0,onToggle:m,isOpen:r,onSelect:(c,l)=>{i(l),m()},selections:a,variant:_.single,"data-testid":"kerberos-cache-policy",children:[e(n,{value:["DEFAULT"],isPlaceholder:!0},0),e(n,{value:["EVICT_DAILY"]},1),e(n,{value:["EVICT_WEEKLY"]},2),e(n,{value:["MAX_LIFESPAN"]},3),e(n,{value:["NO_CACHE"]},4)]})})}),x(h,["EVICT_WEEKLY"])?e(I,{label:t("evictionDay"),labelIcon:e(y,{helpText:"user-federation-help:evictionDayHelp",fieldLabelId:"user-federation:evictionDay"}),isRequired:!0,fieldId:"kc-eviction-day",children:e(p,{name:"config.evictionDay[0]",defaultValue:"1",control:o.control,render:({onChange:i,value:a})=>u(V,{"data-testid":"cache-day",toggleId:"kc-eviction-day",required:!0,onToggle:E,isOpen:F,onSelect:(c,l)=>{i(l),E()},selections:a,variant:_.single,children:[e(n,{value:"1",isPlaceholder:!0,children:t("common:Sunday")},0),e(n,{value:"2",children:t("common:Monday")},1),e(n,{value:"3",children:t("common:Tuesday")},2),e(n,{value:"4",children:t("common:Wednesday")},3),e(n,{value:"5",children:t("common:Thursday")},4),e(n,{value:"6",children:t("common:Friday")},5),e(n,{value:"7",children:t("common:Saturday")},6)]})})}):null,x(h,["EVICT_DAILY"])||x(h,["EVICT_WEEKLY"])?u(b,{children:[e(I,{label:t("evictionHour"),labelIcon:e(y,{helpText:"user-federation-help:evictionHourHelp",fieldLabelId:"user-federation:evictionHour"}),isRequired:!0,fieldId:"kc-eviction-hour",children:e(p,{name:"config.evictionHour",defaultValue:["0"],control:o.control,render:({onChange:i,value:a})=>e(V,{toggleId:"kc-eviction-hour",onToggle:d,isOpen:s,onSelect:(c,l)=>{i(l),d()},selections:a,variant:_.single,children:D})})}),e(I,{label:t("evictionMinute"),labelIcon:e(y,{helpText:"user-federation-help:evictionMinuteHelp",fieldLabelId:"user-federation:evictionMinute"}),isRequired:!0,fieldId:"kc-eviction-minute",children:e(p,{name:"config.evictionMinute",defaultValue:["0"],control:o.control,render:({onChange:i,value:a})=>e(V,{toggleId:"kc-eviction-minute",onToggle:T,isOpen:S,onSelect:(c,l)=>{i(l),T()},selections:a,variant:_.single,children:C})})})]}):null,x(h,["MAX_LIFESPAN"])?e(I,{label:t("maxLifespan"),labelIcon:e(y,{helpText:"user-federation-help:maxLifespanHelp",fieldLabelId:"user-federation:maxLifespan"}),fieldId:"kc-max-lifespan",children:e(p,{name:"config.maxLifespan[0]",defaultValue:0,control:o.control,render:({onChange:i,value:a})=>{const l=f=>i(Math.max(f,0));return e(J,{id:"kc-max-lifespan","data-testid":"kerberos-cache-lifespan",value:a,min:0,unit:t("ms"),type:"text",onPlus:()=>i(Number(a)+1),onMinus:()=>i(Number(a)-1),onChange:f=>{const A=Number(f.currentTarget.value);l(isNaN(A)?0:A)}})}})}):null]})},ue=({form:o,showSectionHeading:t=!1,showSectionDescription:r=!1,unWrap:m=!1})=>{const{t:s}=H("user-federation"),{t:d}=H("user-federation-help");return u(b,{children:[t&&e(Q,{title:s("cacheSettings"),description:d("cacheSettingsDescription"),showDescription:r}),m?e(N,{form:o}):e($,{role:"manage-realm",isHorizontal:!0,children:e(N,{form:o})})]})},me=({provider:o,save:t,noDivider:r=!1,dropdownItems:m=[]})=>{const{t:s}=H("user-federation"),{id:d}=z(),S=W(),{adminClient:T}=q(),{addAlert:F,addError:E}=U(),{realm:h}=Y(),{control:D,setValue:g}=w(),[C,v]=P({titleKey:"user-federation:userFedDisableConfirmTitle",messageKey:"user-federation:userFedDisableConfirm",continueButtonLabel:"common:disable",onConfirm:()=>{g("config.enabled[0]","false"),t()}}),[i,a]=P({titleKey:"user-federation:userFedDeleteConfirmTitle",messageKey:"user-federation:userFedDeleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:B.danger,onConfirm:async()=>{try{await T.components.del({id:d}),F(s("userFedDeletedSuccess"),R.success),S(j({realm:h}),{replace:!0})}catch(c){E("user-federation:userFedDeleteError",c)}}});return u(b,{children:[e(v,{}),e(a,{}),e(p,{name:"config.enabled[0]",defaultValue:["true"][0],control:D,render:({onChange:c,value:l})=>d?e(k,{divider:!r,titleKey:o,dropdownItems:[...m,e(X,{onClick:()=>i(),"data-testid":"delete-cmd",children:s("deleteProvider")},"delete")],isEnabled:l==="true",onToggle:f=>{f?(c(f.toString()),t()):C()}}):e(k,{titleKey:s("addProvider",{provider:o,count:1})})})]})};export{me as H,ue as S,Q as W};
