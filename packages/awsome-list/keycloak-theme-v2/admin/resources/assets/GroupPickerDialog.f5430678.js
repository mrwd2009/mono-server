import{_ as F,j as t,q as P,J as U,h as p,F as X,r as d,a4 as z,u as K,ay as Q,a_ as W,s as w,bE as Y,bF as R,bG as Z}from"./index.0cb2e516.js";import{P as ee,L as $}from"./KeycloakDataTable.4e517788.js";import{e as se,D as te,a as ae,c as ie,d as ne}from"./DataListItemRow.8f458244.js";import{s as v}from"./data-list.f7ff2ea7.js";import{M as le,a as oe}from"./Modal.6593dfcc.js";const T=i=>{var{children:o,className:m,visibility:c,id:f,"aria-label":k,"aria-labelledby":h,isPlainButtonAction:a}=i,u=F(i,["children","className","visibility","id","aria-label","aria-labelledby","isPlainButtonAction"]);return t("div",{...Object.assign({className:P(v.dataListItemAction,U(c,v),m)},u),children:a?t("div",{className:P(v.dataListAction),children:o}):o})};T.displayName="DataListAction";const O=i=>{var{className:o="",onChange:m=(n,g)=>{},isValid:c=!0,isDisabled:f=!1,isChecked:k=!1,checked:h=!1,defaultChecked:a,otherControls:u=!1}=i,b=F(i,["className","onChange","isValid","isDisabled","isChecked","checked","defaultChecked","otherControls"]);const G=t("div",{className:P(v.dataListCheck),children:t("input",{...Object.assign({},b,{type:"checkbox",onChange:n=>m(n.currentTarget.checked,n),"aria-invalid":!c,disabled:f},[!0,!1].includes(a)&&{defaultChecked:a},![!0,!1].includes(a)&&{checked:k||h})})});return p(X,{children:[!u&&t("div",{className:P(v.dataListItemControl,o),children:G}),u&&G]})};O.displayName="DataListCheck";const re=20,B=10,ce=i=>i&&i.length>=re?i.substr(0,B)+"..."+i.substr(i.length-B,i.length):i,de=({group:{path:i},onMouseEnter:o,...m})=>{const[c,f]=d.exports.useState(""),h=t("span",{onMouseEnter:a=>{f(i),o?.(a)},...m,children:ce(i)});return c!==""?t(z,{content:c,isVisible:!0,children:h}):h},pe=({id:i,type:o,filterGroups:m,text:c,canBrowse:f=!0,onClose:k,onConfirm:h})=>{const{t:a}=K(),{adminClient:u}=Q(),[b,G]=d.exports.useState([]),[n,g]=d.exports.useState([]),[y,V]=d.exports.useState([]),[r,_]=d.exports.useState(""),[J,q]=d.exports.useState([]),[I,L]=d.exports.useState(),[x,A]=d.exports.useState(10),[M,N]=d.exports.useState(0),E=()=>n[n.length-1];W(async()=>{let e,s,l;if(!I)s=await u.groups.find({first:M,max:x+1,search:r});else{if(e=await u.groups.findOne({id:I}),!e)throw new Error(a("common:notFound"));s=e.subGroups}return i&&(l=await u.users.listGroups({id:i})),{group:e,groups:s,existingUserGroups:l}},async({group:e,groups:s,existingUserGroups:l})=>{q(l||[]),e&&g([...n,e]),s.forEach(C=>{C.checked=!!b.find(H=>H.id===C.id)}),V(s)},[I,r,M,x]);const D=e=>[...J.map(s=>s.name),...m||[]].some(s=>s===e?.name),j=e=>e.subGroups?.length!==0,S=(e,s)=>{if(e.name?.includes(s))return e;if(e.subGroups)for(const l of e.subGroups)return S(l,s);return e};return t(le,{variant:oe.small,title:a(c.title,{group1:m?.[0],group2:n.length?E().name:a("root")}),isOpen:!0,onClose:k,actions:[t(w,{"data-testid":`${c.ok}-button`,variant:"primary",form:"group-form",onClick:()=>{h(o==="selectMany"?b:n.length?[E()]:void 0)},isDisabled:o==="selectMany"&&b.length===0,children:a(c.ok)},"confirm")],children:p(ee,{count:y.length,first:M,max:x,onNextClick:N,onPreviousClick:N,onPerPageSelect:(e,s)=>{N(e),A(s)},inputGroupName:"common:search",inputGroupOnEnter:e=>{_(e),N(0),A(10),g([])},inputGroupPlaceholder:a("users:searchForGroups"),children:[p(Y,{children:[n.length>0&&t(R,{children:t(w,{variant:"link",onClick:()=>{L(void 0),g([])},children:a("groups")})},"home"),n.map((e,s)=>p(R,{children:[n.length-1!==s&&t(w,{variant:"link",onClick:()=>{L(e.id),g([...n].slice(0,s))},children:e.name}),n.length-1===s&&e.name]},s))]}),p(se,{"aria-label":a("groups"),isCompact:!0,children:[y.slice(0,x).map(e=>t(te,{className:`join-group-dialog-row-${D(e)?"disabled":""}`,"aria-labelledby":e.name,id:e.id,onClick:s=>{const l=r!==""?S(e,r):e;D(l)||(o==="selectOne"?L(l.id):j(e)&&r===""&&s.target.type!=="checkbox"&&L(e.id))},children:p(ae,{className:`join-group-dialog-row-${D(e)?"m-disabled":""}`,"data-testid":e.name,children:[o==="selectMany"&&t(O,{className:"kc-join-group-modal-check","data-testid":`${e.name}-check`,"aria-label":e.name,checked:e.checked,isDisabled:D(e),onChange:s=>{e.checked=s;let l=[];e.checked?l=[...b,r===""?e:S(e,r)]:l=b.filter(C=>C.id!==e.id),G(l)},"aria-labelledby":`select-${e.name}`}),t(ie,{dataListCells:[t(ne,{children:r===""?t("span",{id:`select-${e.name}`,children:e.name}):t(de,{id:`select-${e.name}`,group:S(e,r)})},`name-${e.id}`)]}),t(T,{id:"actions","aria-labelledby":`select-${e.name}`,"aria-label":a("groupName"),isPlainButtonAction:!0,children:(j(e)&&r===""&&f||o==="selectOne")&&t(w,{isDisabled:!0,variant:"link","aria-label":a("common:select"),children:t(Z,{})})})]})},e.id)),y.length===0&&r===""&&t($,{hasIcon:!1,message:a("groups:moveGroupEmpty"),instructions:a("groups:moveGroupEmptyInstructions")}),y.length===0&&r!==""&&t($,{message:a("common:noSearchResults"),instructions:a("common:noSearchResultsInstructions")})]})]})})};export{pe as G,de as a};
