import{_ as T,j as e,q as G,ac as ee,u as K,ay as j,az as z,r as c,h as m,s as O,ae as E,T as N,b8 as ae,aw as _,bM as te,an as re,am as oe,L as ne,l as se,g as ie,a_ as le,ap as M,cY as L,o as x,aY as ce,F as A,b2 as de,P as me,b0 as pe,b1 as B}from"./index.0cb2e516.js";import{u as ue}from"./ConfirmDialog.f8013bbb.js";import{M as ge,a as he}from"./Modal.6593dfcc.js";import{T as P,a as U}from"./Text.c38ffb52.js";import{e as fe,D as Ce,a as De,b as ye,c as ve,d as be}from"./DataListItemRow.8f458244.js";import{D as Se}from"./DataListControl.30ac2ba7.js";import{C as H,G as V}from"./ClickableCard.b12e8fc6.js";import{s as F}from"./Card.32e78d5f.js";import{C as ke}from"./CardHeader.f162738f.js";import{C as R}from"./CardTitle.42e61ef4.js";import{C as we}from"./CardBody.a2e5e179.js";import{F as Ie,a as $}from"./FlexItem.308d9f82.js";import{V as xe}from"./ViewHeader.2586557f.js";import"./data-list.f7ff2ea7.js";import"./grip-vertical-icon.1b75ab8f.js";import"./HelpItem.e440d5db.js";const Y=t=>{var{children:s=null,className:r="",hasNoOffset:i=!1}=t,o=T(t,["children","className","hasNoOffset"]);return e("div",{...Object.assign({className:G(F.cardActions,i&&F.modifiers.noOffset,r)},o),children:s})};Y.displayName="CardActions";const q=t=>{var{children:s=null,className:r="",component:i="div"}=t,o=T(t,["children","className","component"]);return e(i,{...Object.assign({className:G(F.cardFooter,r)},o),children:s})};q.displayName="CardFooter";const J=t=>{var{children:s=null,component:r="div"}=t,i=T(t,["children","component"]);return e(r,{...Object.assign({},i),children:s})};J.displayName="GalleryItem";const Ne={name:"DatabaseIcon",height:512,width:448,svgPath:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z",yOffset:0,xOffset:0},Pe=ee(Ne),Fe=({components:t,onClose:s})=>{const{t:r}=K("user-federation"),{adminClient:i}=j(),{addAlert:o,addError:l}=z(),[p,h]=c.exports.useState(""),[D,d]=c.exports.useState(""),[u,y]=c.exports.useState(t.map(n=>n.name)),f=n=>{h(n),d(r("common:onDragStart",{item:n}))},v=()=>{d(r("common:onDragMove",{item:p}))},g=()=>{d(r("common:onDragCancel"))},k=n=>{d(r("common:onDragFinish",{list:n})),y(n)};return m(ge,{variant:he.small,title:r("managePriorityOrder"),isOpen:!0,onClose:s,actions:[e(O,{id:"modal-confirm",onClick:async()=>{const n=u.map((b,w)=>{const S=t.find(I=>I.name===b);return S.config.priority=[w.toString()],i.components.update({id:S.id},S)});try{await Promise.all(n),o(r("orderChangeSuccess"))}catch(b){l("orderChangeError",b)}s()},children:r("common:save")},"confirm"),e(O,{id:"modal-cancel",variant:E.link,onClick:s,children:r("common:cancel")},"cancel")],children:[e(N,{className:"pf-u-pb-lg",children:e(P,{children:r("managePriorityInfo")})}),e(fe,{"aria-label":r("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:k,onDragStart:f,onDragMove:v,onDragCancel:g,itemOrder:u,children:ae(t,"config.priority","name").map(n=>e(Ce,{"aria-label":n.name,id:n.name,children:m(De,{children:[e(Se,{children:e(ye,{"aria-label":r("common-help:dragHelp")})}),e(ve,{dataListCells:[e(be,{"data-testid":n.name,children:n.name},n.name)]})]})},n.name))}),e("div",{className:"pf-screen-reader","aria-live":"assertive",children:D})]})};const Te=({id:t,title:s,dropdownItems:r,labelText:i,labelColor:o,footerText:l,providerId:p})=>{const[h,D]=c.exports.useState(!1),d=_(),{url:u}=te(),y=()=>{D(!h)},f=g=>{g.stopPropagation()};return m(H,{isSelectable:!0,onClick:()=>{d(`${u}/${p}/${t}`)},children:[m(ke,{children:[e(Y,{children:r&&e(re,{"data-testid":`${s}-dropdown`,isPlain:!0,position:"right",toggle:e(oe,{onToggle:y}),onClick:g=>f(g),isOpen:h,dropdownItems:r})}),e(R,{"data-testid":"keycloak-card-title",children:s})]}),e(we,{}),e(q,{children:m(Ie,{children:[e($,{className:"keycloak--keycloak-card__footer",children:l&&l}),e($,{children:i&&e(ne,{color:o||"gray",children:i})})]})})]})};function Ye(){const[t,s]=c.exports.useState(),{addAlert:r,addError:i}=z(),{t:o}=K("user-federation"),{realm:l}=se(),{adminClient:p}=j(),[h,D]=c.exports.useState(0),d=()=>D(new Date().getTime()),u=_(),[y,f]=c.exports.useState(!1),v=ie().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[];le(async()=>{const C={parentId:(await p.realms.findOne({realm:l})).id,type:"org.keycloak.storage.UserStorageProvider"};return p.components.find(C)},a=>{s(a)},[h]);const g=c.exports.useMemo(()=>v.map(a=>e(M,{onClick:()=>u(L({realm:l,providerId:a.id,id:"new"})),children:a.id.toUpperCase()=="LDAP"?a.id.toUpperCase():x(a.id)},a.id)),[]),k={variant:"link",onClick:()=>f(!0),lowerButtonTitle:o("managePriorities")};let n;const[b,w]=c.exports.useState(""),[S,I]=ue({titleKey:o("userFedDeleteConfirmTitle"),messageKey:o("userFedDeleteConfirm"),continueButtonLabel:"common:delete",continueButtonVariant:E.danger,onConfirm:async()=>{try{await p.components.del({id:b}),d(),r(o("userFedDeletedSuccess"),ce.success)}catch(a){i("user-federation:userFedDeleteError",a)}}}),Q=a=>{w(a),S()},W=(a,C)=>{const X=`${a.name}`,Z=`${C.name}`;return X<Z?-1:1};return t&&(n=t.sort(W).map((a,C)=>e(J,{className:"keycloak-admin--user-federation__gallery-item",children:e(Te,{id:a.id,dropdownItems:[e(M,{onClick:()=>{Q(a.id)},"data-testid":"card-delete",children:o("common:delete")},`${C}-cardDelete`)],providerId:a.providerId,title:a.name,footerText:x(a.providerId),labelText:a.config?.enabled?.[0]!=="false"?`${o("common:enabled")}`:`${o("common:disabled")}`,labelColor:a.config?.enabled?.[0]!=="false"?"blue":"gray"})},C))),m(A,{children:[e(I,{}),y&&t&&e(Fe,{onClose:()=>f(!1),components:t.filter(a=>a.config?.enabled)}),e(xe,{titleKey:"userFederation",subKey:"user-federation:userFederationExplain",helpUrl:de.userFederationUrl,...t&&t.length>0?{lowerDropdownItems:g,lowerDropdownMenuTitle:"user-federation:addNewProvider",lowerButton:k}:{}}),e(me,{children:t&&t.length>0?e(V,{hasGutter:!0,children:n}):m(A,{children:[e(N,{children:e(P,{component:U.p,children:o("getStarted")})}),e(N,{children:e(P,{className:"pf-u-mt-lg",component:U.h2,children:o("providers")})}),e("hr",{className:"pf-u-mb-lg"}),e(V,{hasGutter:!0,children:v.map(a=>e(H,{onClick:()=>u(L({realm:l,providerId:a.id})),"data-testid":`${a.id}-card`,children:e(R,{children:m(pe,{hasGutter:!0,children:[e(B,{children:e(Pe,{size:"lg"})}),e(B,{isFilled:!0,children:o("addProvider",{provider:x(a.id),count:4})})]})})},a.id))})]})})]})}export{Ye as default};
