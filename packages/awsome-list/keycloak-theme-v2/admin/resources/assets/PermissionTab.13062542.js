import{u as v,aw as w,ay as D,l as E,r as b,a_ as L,j as s,K as k,h as n,P as x,aA as K,F as _,b4 as j,bY as P}from"./index.0cb2e516.js";import{H as A}from"./HelpItem.e440d5db.js";import{u as H}from"./useLocaleSort.84ea7ec0.js";import{u as G}from"./ConfirmDialog.f8013bbb.js";import{T as $}from"./Trans.ec4d13b3.js";import{C as p}from"./Card.32e78d5f.js";import{C as g}from"./CardTitle.42e61ef4.js";import{C as d}from"./CardBody.a2e5e179.js";import{F as B,a as M}from"./FormGroup.3d5f3f16.js";import{a as O,b as R,c as C,d as T,e as U,f as u,N as z}from"./TableToolbar.c27bcd3c.js";const is=({id:a,type:m})=>{const{t:i}=v("common"),y=w(),{adminClient:r}=D(),{realm:t}=E(),[h,F]=b.exports.useState(""),[l,c]=b.exports.useState(),I=H(),f=e=>{switch(m){case"clients":return r.clients.updateFineGrainPermission({id:a},{enabled:e});case"users":return r.realms.updateUsersManagementPermissions({realm:t,enabled:e});case"groups":return r.groups.updatePermission({id:a},{enabled:e});case"roles":return r.roles.updatePermission({id:a},{enabled:e});case"identityProviders":return r.identityProviders.updatePermission({alias:a},{enabled:e})}};L(()=>Promise.all([r.clients.find({search:!0,clientId:t==="master"?"master-realm":"realm-management"}),(()=>{switch(m){case"clients":return r.clients.listFineGrainPermissions({id:a});case"users":return r.realms.getUsersManagementPermissions({realm:t});case"groups":return r.groups.listPermissions({id:a});case"roles":return r.roles.listPermissions({id:a});case"identityProviders":return r.identityProviders.listPermissions({alias:a})}})()]),([e,o])=>{F(e[0]?.id),c(o)},[]);const[N,S]=G({titleKey:"common:permissionsDisable",messageKey:"common:permissionsDisableConfirm",continueButtonLabel:"common:confirm",onConfirm:async()=>{const e=await f(!1);c(e)}});return l?n(x,{variant:"light",children:[s(S,{}),n(p,{isFlat:!0,children:[s(g,{children:i("permissions")}),n(d,{children:[i(`${m}PermissionsHint`),s(B,{isHorizontal:!0,className:"pf-u-pt-md",children:s(M,{hasNoPaddingTop:!0,className:"permission-label",label:i("permissionsEnabled"),fieldId:"permissionsEnabled",labelIcon:s(A,{helpText:"clients-help:permissionsEnabled",fieldLabelId:"clients:permissionsEnabled"}),children:s(K,{id:"permissionsEnabled","data-testid":"permissionSwitch",label:i("common:on"),labelOff:i("common:off"),isChecked:l.enabled,onChange:async e=>{if(e){const o=await f(e);c(o)}else N()},"aria-label":i("permissionsEnabled")})})})]})]}),l.enabled&&n(_,{children:[n(p,{isFlat:!0,className:"pf-u-mt-lg",children:[s(g,{children:i("permissionsList")}),s(d,{children:n($,{i18nKey:"common:permissionsListIntro",children:[" ",s("strong",{children:{realm:t==="master"?"master-realm":"realm-management"}}),"."]})})]}),s(p,{isFlat:!0,className:"keycloak__permission__permission-table",children:s(d,{className:"pf-u-p-0",children:n(O,{"aria-label":i("permissionsList"),variant:"compact",children:[s(R,{children:n(C,{children:[s(T,{id:"permissionsScopeName",children:i("permissionsScopeName")}),s(T,{id:"description",children:i("description")})]})}),s(U,{children:I(Object.entries(l.scopePermissions||{}),([e])=>e).map(([e,o])=>n(C,{children:[s(u,{children:s(j,{to:P({realm:t,id:h,permissionType:"scope",permissionId:o}),children:e})}),s(u,{children:i(`scopePermissions.${m}.${e}-description`)}),s(u,{isActionCell:!0,children:s(z,{items:[{title:i("common:edit"),onClick(){y(P({realm:t,id:h,permissionType:"scope",permissionId:o}))}}]})})]},o))})]})})})]})]}):s(k,{})};export{is as P};
