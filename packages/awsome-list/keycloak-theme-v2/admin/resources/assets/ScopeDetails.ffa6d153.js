import{u as F,bA as T,aw as U,ay as z,az as k,r as C,a_ as V,h as d,F as H,j as e,c5 as m,ap as L,P as j,av as n,s as p,ae as q,b4 as E,aY as K}from"./index.0cb2e516.js";import{u as P}from"./index.esm.6af887f8.js";import{F as B}from"./FormAccess.bee4f1e0.js";import{H as u}from"./HelpItem.e440d5db.js";import{V as G}from"./ViewHeader.2586557f.js";import{K as h}from"./KeycloakTextInput.b4d5b2db.js";import{u as O}from"./useToggle.8c992bea.js";import{D as R}from"./DeleteScopeDialog.f883bfb4.js";import{a as f,A as Y}from"./FormGroup.3d5f3f16.js";import"./copy-icon.cf10e1f5.js";import"./GridItem.0db472b0.js";import"./Text.c38ffb52.js";import"./ConfirmDialog.f8013bbb.js";import"./Modal.6593dfcc.js";function ne(){const{t}=F("clients"),{id:i,scopeId:o,realm:s}=T(),v=U(),{adminClient:l}=z(),{addAlert:S,addError:A}=k(),[N,I]=O(),[r,b]=C.exports.useState(),{register:c,reset:g,handleSubmit:w,formState:{errors:y}}=P({mode:"onChange"});V(async()=>{if(o){const a=await l.clients.getAuthorizationScope({id:i,scopeId:o});if(!a)throw new Error(t("common:notFound"));return a}},a=>{b(a),g({...a})},[]);const D=async a=>{try{o?(await l.clients.updateAuthorizationScope({id:i,scopeId:o},a),b(a)):(await l.clients.createAuthorizationScope({id:i},{name:a.name,displayName:a.displayName,iconUri:a.iconUri}),v(m({realm:s,clientId:i,tab:"scopes"}))),S(t((o?"update":"create")+"ScopeSuccess"),K.success)}catch(x){A("clients:scopeSaveError",x)}};return d(H,{children:[e(R,{clientId:i,open:N,toggleDialog:I,selectedScope:r,refresh:()=>v(m({realm:s,clientId:i,tab:"scopes"}))}),e(G,{titleKey:o?r?.name:t("clients:createAuthorizationScope"),dropdownItems:o?[e(L,{"data-testid":"delete-resource",onClick:()=>I(),children:t("common:delete")},"delete")]:void 0}),e(j,{variant:"light",children:d(B,{isHorizontal:!0,role:"view-clients",onSubmit:w(D),children:[e(f,{label:t("common:name"),fieldId:"name",labelIcon:e(u,{helpText:"clients-help:scopeName",fieldLabelId:"name"}),helperTextInvalid:t("common:required"),validated:y.name?n.error:n.default,isRequired:!0,children:e(h,{id:"name",name:"name",ref:c({required:!0}),validated:y.name?n.error:n.default})}),e(f,{label:t("displayName"),fieldId:"displayName",labelIcon:e(u,{helpText:"clients-help:scopeDisplayName",fieldLabelId:"displayName"}),children:e(h,{id:"displayName",name:"displayName",ref:c})}),e(f,{label:t("iconUri"),fieldId:"iconUri",labelIcon:e(u,{helpText:"clients-help:iconUri",fieldLabelId:"clients:iconUri"}),children:e(h,{id:"iconUri",name:"iconUri",ref:c})}),e(Y,{children:d("div",{className:"pf-u-mt-md",children:[e(p,{variant:q.primary,type:"submit","data-testid":"save",children:t("common:save")}),r?e(p,{variant:"link","data-testid":"revert",onClick:()=>g({...r}),children:t("common:revert")}):e(p,{variant:"link","data-testid":"cancel",component:a=>e(E,{...a,to:m({realm:s,clientId:i,tab:"scopes"})}),children:t("common:cancel")})]})})]})})]})}export{ne as default};
