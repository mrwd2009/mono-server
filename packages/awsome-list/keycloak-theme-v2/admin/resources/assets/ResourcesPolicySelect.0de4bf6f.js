import{u as j,ay as v,r as d,a_ as V,j as u}from"./index.0cb2e516.js";import{a as M,C as T}from"./index.esm.6af887f8.js";import{S as w,b as D,a as I}from"./Select.5a6b39aa.js";const L={resources:{searchFunction:"listResources",fetchFunction:"getAssociatedResources"},policies:{searchFunction:"listPolicies",fetchFunction:"getAssociatedPolicies"}},B=({name:t,clientId:f,permissionId:m,variant:F=D.typeaheadMulti,preSelected:n,isRequired:x=!1})=>{const{t:h}=j("clients"),{adminClient:p}=v(),{control:y,formState:{errors:b}}=M(),[A,C]=d.exports.useState([]),[a,r]=d.exports.useState(""),[O,P]=d.exports.useState(!1),S=L[t],_=e=>({id:"_id"in e?e._id:"id"in e?e.id:void 0,name:e.name});V(async()=>{const e=Object.assign({id:f,first:0,max:10,permission:"false"},a===""?null:{name:a});return(await Promise.all([p.clients[S.searchFunction](e),m?p.clients[S.fetchFunction]({id:f,permissionId:m}):Promise.resolve([])])).flat().map(_).filter(({id:s},c,i)=>c===i.findIndex(({id:o})=>s===o))},C,[a]);const g=()=>A.map(e=>u(I,{value:e.id,children:e.name},e.id));return u(T,{name:t,defaultValue:n?[n]:[],control:y,rules:{validate:e=>!x||e.length>0},render:({onChange:e,value:s})=>u(w,{toggleId:t,variant:F,onToggle:P,onFilter:(c,i)=>(r(i),g()),onClear:()=>{e([]),r("")},selections:s,onSelect:(c,i)=>{const o=i.toString(),R=s.find(l=>l===o)?s.filter(l=>l!==o):[...s,o];e(R),r("")},isOpen:O,"aria-labelledby":h(t),isDisabled:!!n,validated:b[t]?"error":"default",typeAheadAriaLabel:h(t),children:g()})})};export{B as R};
