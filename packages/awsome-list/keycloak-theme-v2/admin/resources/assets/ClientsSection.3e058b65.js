import{u as E,ay as P,az as v,l as F,aw as Y,r as D,ae as j,aY as N,h as r,F as b,j as n,s as k,b4 as h,ce as K,n as q,aD as G,b2 as J,P as Q,bO as I,c6 as U,bD as x,bP as X,ai as Z,cf as ee,cg as te}from"./index.0cb2e516.js";import{u as V}from"./ConfirmDialog.f8013bbb.js";import{V as ne,f as ie}from"./ViewHeader.2586557f.js";import{K as M,L as ae}from"./KeycloakDataTable.4e517788.js";import{j as L}from"./joinPath.69b856b1.js";import{u as se,F as R}from"./useFormatDate.53169b6c.js";import{A as oe,ah as re,aj as le}from"./TableToolbar.c27bcd3c.js";import{i as ce,g as me}from"./utils.988d95db.js";import{R as de,r as pe}from"./RoutableTabs.f3cff418.js";import{T as w,a as B}from"./Tabs.3d61d369.js";import{c as S}from"./HelpItem.e440d5db.js";import"./Modal.6593dfcc.js";import"./Text.c38ffb52.js";import"./plus-circle-icon.32cdf4dc.js";import"./EmptyStateBody.a0363fe4.js";import"./EmptyStateSecondaryActions.1a804d56.js";import"./star-icon.97692015.js";import"./check.51c67984.js";import"./FormGroup.3d5f3f16.js";import"./grip-vertical-icon.1b75ab8f.js";import"./Checkbox.2dc73ed3.js";import"./plus-icon.407671b4.js";import"./MenuList.288a98b4.js";const ue=()=>({className:oe.modifiers.wrap}),ye=({rootUrl:e,baseUrl:a},l)=>a?.startsWith("http")?a:(e==="${authBaseUrl}"||e==="${authAdminUrl}")&&a?e.replace(/\$\{(authAdminUrl|authBaseUrl)\}/,L(l,a)):e?.startsWith("http")?a?L(e,a):e:a,he=()=>{const{t:e}=E("clients"),{adminClient:a}=P(),{addAlert:l,addError:c}=v(),{realm:s}=F(),p=se(),f=Y(),[m,u]=D.exports.useState(),y=async()=>{try{return await a.realms.getClientsInitialAccess({realm:s})}catch{return[]}},[C,g]=V({titleKey:"clients:tokenDeleteConfirmTitle",messageKey:e("tokenDeleteConfirm",m),continueButtonLabel:"common:delete",continueButtonVariant:j.danger,onConfirm:async()=>{try{await a.realms.delClientsInitialAccess({realm:s,id:m.id}),l(e("tokenDeleteSuccess"),N.success),u(void 0)}catch(i){c("tokenDeleteError",i)}}});return r(b,{children:[n(g,{}),n(M,{ariaLabelKey:"clients:initialAccessToken",searchPlaceholderKey:"clients:searchInitialAccessToken",loader:y,toolbarItem:n(k,{component:i=>n(h,{...i,to:K({realm:s})}),children:e("common:create")}),actions:[{title:e("common:delete"),onRowClick:i=>{u(i),C()}}],columns:[{name:"id",displayKey:"common:id"},{name:"timestamp",displayKey:"clients:timestamp",cellRenderer:i=>p(new Date(i.timestamp*1e3),R)},{name:"expiration",displayKey:"clients:expires",cellRenderer:i=>p(new Date(i.timestamp*1e3+i.expiration*1e3),R)},{name:"count",displayKey:"clients:count"},{name:"remainingCount",displayKey:"clients:remainingCount",transforms:[ue]}],emptyState:n(ae,{message:e("noTokens"),instructions:e("noTokensInstructions"),primaryActionText:e("common:create"),onPrimaryAction:()=>f(K({realm:s}))})},m?.id)]})};function Me(){const{t:e}=E("clients"),{addAlert:a,addError:l}=v(),{adminClient:c}=P(),{realm:s}=F(),p=q(),[f,m]=D.exports.useState(0),u=()=>m(new Date().getTime()),[y,C]=D.exports.useState(),{hasAccess:g}=G(),i=g("manage-clients"),$=async(t,o,d)=>{const T={first:t,max:o};return d&&(T.clientId=d,T.search=!0),await c.clients.find({...T})},[O,W]=V({titleKey:e("clientDelete",{clientId:y?.clientId}),messageKey:"clients:clientDeleteConfirm",continueButtonLabel:"common:delete",continueButtonVariant:j.danger,onConfirm:async()=>{try{await c.clients.del({id:y.id}),a(e("clientDeletedSuccess"),N.success),u()}catch(t){l("clients:clientDeleteError",t)}}}),_=t=>r(h,{to:X({realm:s,clientId:t.id,tab:"settings"}),children:[t.clientId,!t.enabled&&n(Z,{isRead:!0,className:"pf-u-ml-sm",children:e("common:disabled")},`${t.id}-disabled`)]},t.id),H=t=>n(le,{wrapModifier:"truncate",children:x()(t.description)}),z=()=>i?r(b,{children:[n(S,{children:n(k,{component:t=>n(h,{...t,to:ee({realm:s})}),children:e("createClient")})}),n(S,{children:n(k,{component:t=>n(h,{...t,to:te({realm:s})}),variant:"link","data-testid":"importClient",children:e("importClient")})})]}):n("span",{}),A=t=>pe({to:I({realm:s,tab:t}),history:p});return r(b,{children:[n(ne,{titleKey:"clients:clientList",subKey:"clients:clientsExplain",helpUrl:J.clientsUrl,divider:!1}),n(Q,{variant:"light",className:"pf-u-p-0",children:r(de,{mountOnEnter:!0,isBox:!0,defaultLocation:I({realm:s,tab:"list"}),children:[r(w,{"data-testid":"list",title:n(B,{children:e("clientsList")}),...A("list"),children:[n(W,{}),n(M,{loader:$,isPaginated:!0,ariaLabelKey:"clients:clientList",searchPlaceholderKey:"clients:searchForClient",toolbarItem:n(z,{}),actionResolver:t=>{const o=t.data,d=[{title:e("common:export"),onClick(){U(o)}}];return!ce(o)&&(i||o.access?.configure)&&d.push({title:e("common:delete"),onClick(){C(o),O()}}),d},columns:[{name:"clientId",displayKey:"common:clientId",cellRenderer:_},{name:"protocol",displayKey:"common:type",cellRenderer:t=>me(e,t.protocol??"openid-connect")},{name:"description",displayKey:"common:description",transforms:[re(20)],cellRenderer:H},{name:"baseUrl",displayKey:"clients:homeURL",cellFormatters:[ie(),x()],cellRenderer:t=>ye(t,c.baseUrl)}]},f)]}),n(w,{"data-testid":"initialAccessToken",title:n(B,{children:e("initialAccessToken")}),...A("initial-access-token"),children:n(he,{})})]})})]})}export{Me as default};
