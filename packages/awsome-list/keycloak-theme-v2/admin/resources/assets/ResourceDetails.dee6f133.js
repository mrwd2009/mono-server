import{u as V,r as h,ay as _,a_ as k,j as e,az as j,bA as E,aw as H,h as w,F as L,bR as q,aY as N,c5 as D,K as G,ap as W,P as Y,av as v,aA as J,s as M,ae as Q,b4 as X,aC as Z,b_ as $,aB as ee}from"./index.0cb2e516.js";import{a as te,C as K,u as re,F as se}from"./index.esm.6af887f8.js";import{H as l}from"./HelpItem.e440d5db.js";import{V as ae}from"./ViewHeader.2586557f.js";import{u as ne}from"./ConfirmDialog.f8013bbb.js";import{F as oe}from"./FormAccess.bee4f1e0.js";import{M as ie}from"./MultiLineInput.e27bc560.js";import{a as c,A as le}from"./FormGroup.3d5f3f16.js";import{S as ce,b as de,a as me}from"./Select.5a6b39aa.js";import{K as ue}from"./KeyValueInput.cb1ae3e8.js";import{K as y}from"./KeycloakTextInput.b4d5b2db.js";import"./Text.c38ffb52.js";import"./Modal.6593dfcc.js";import"./copy-icon.cf10e1f5.js";import"./GridItem.0db472b0.js";import"./minus-circle-icon.de526f05.js";import"./plus-circle-icon.32cdf4dc.js";import"./check.51c67984.js";import"./star-icon.97692015.js";import"./FlexItem.308d9f82.js";const pe=({clientId:t})=>{const{t:m}=V("clients"),{control:A}=te(),[T,R]=h.exports.useState(!1),[f,C]=h.exports.useState(),[i,b]=h.exports.useState(""),{adminClient:x}=_();k(()=>{const n={id:t,first:0,max:20,deep:!1,name:i};return x.clients.listAllScopes(n)},C,[i]);const I=n=>n?.map(o=>e(me,{value:o,children:o.name},o.id));return e(c,{label:m("authorizationScopes"),labelIcon:e(l,{helpText:"clients-help:scopes",fieldLabelId:"clients:scopes"}),fieldId:"scopes",children:e(K,{name:"scopes",defaultValue:[],control:A,render:({onChange:n,value:o})=>e(ce,{toggleId:"scopes",variant:de.typeaheadMulti,chipGroupProps:{numChips:3,expandedText:m("common:hide"),collapsedText:m("common:showRemaining")},onToggle:R,isOpen:T,selections:o.map(u=>u.name),onFilter:(u,d)=>(b(d),I(f)),onSelect:(u,d)=>{const S=typeof d=="string"?d:d.name,a=o.find(s=>s.name===S)?o.filter(s=>s.name!==S):[...o,d];n(a)},onClear:u=>{u.stopPropagation(),b(""),n([])},"aria-label":m("authorizationScopes"),children:I(f)})})})};function Ve(){const{t}=V("clients"),[m,A]=h.exports.useState(),[T,R]=h.exports.useState(),[f,C]=h.exports.useState(),{adminClient:i}=_(),{addAlert:b,addError:x}=j(),I=re({shouldUnregister:!1,mode:"onChange"}),{register:n,errors:o,control:u,setValue:d,handleSubmit:S}=I,{id:a,resourceId:s,realm:F}=E(),P=H(),O=(r={})=>{ee(r,d)};k(()=>Promise.all([i.clients.findOne({id:a}),s?i.clients.getResource({id:a,resourceId:s}):Promise.resolve(void 0),s?i.clients.listPermissionsByResource({id:a,resourceId:s}):Promise.resolve(void 0)]),([r,p,g])=>{if(!r)throw new Error(t("common:notFound"));A(r),C(g),R(p),O(p)},[]);const U=async r=>{const p=Z(r);try{if(s)await i.clients.updateResource({id:a,resourceId:s},p);else{const g=await i.clients.createResource({id:a},p);P($({realm:F,id:a,resourceId:g._id}))}b(t((s?"update":"create")+"ResourceSuccess"),N.success)}catch(g){x("clients:resourceSaveError",g)}},[B,z]=ne({titleKey:"clients:deleteResource",children:w(L,{children:[t("deleteResourceConfirm"),f?.length!==0&&e(q,{variant:"warning",isInline:!0,isPlain:!0,title:t("deleteResourceWarning"),className:"pf-u-pt-lg",children:e("p",{className:"pf-u-pt-xs",children:f?.map(r=>e("strong",{className:"pf-u-pr-md",children:r.name},r.id))})})]}),continueButtonLabel:"clients:confirm",onConfirm:async()=>{try{await i.clients.delResource({id:a,resourceId:s}),b(t("resourceDeletedSuccess"),N.success),P(D({realm:F,clientId:a,tab:"resources"}))}catch(r){x("clients:resourceDeletedError",r)}}});return m?w(L,{children:[e(z,{}),e(ae,{titleKey:s?T?.name:"clients:createResource",dropdownItems:s?[e(W,{"data-testid":"delete-resource",onClick:()=>B(),children:t("common:delete")},"delete")]:void 0}),e(Y,{variant:"light",children:e(se,{...I,children:w(oe,{isHorizontal:!0,role:"view-clients",className:"keycloak__resource-details__form",onSubmit:S(U),children:[e(c,{label:t("owner"),fieldId:"owner",labelIcon:e(l,{helpText:"clients-help:owner",fieldLabelId:"clients:owner"}),children:e(y,{id:"owner",value:m.clientId,isReadOnly:!0})}),e(c,{label:t("common:name"),fieldId:"name",labelIcon:e(l,{helpText:"clients-help:resourceName",fieldLabelId:"name"}),helperTextInvalid:t("common:required"),validated:o.name?v.error:v.default,isRequired:!0,children:e(y,{id:"name",name:"name",ref:n({required:!0}),validated:o.name?v.error:v.default})}),e(c,{label:t("displayName"),fieldId:"displayName",labelIcon:e(l,{helpText:"clients-help:displayName",fieldLabelId:"name"}),children:e(y,{id:"displayName",name:"name",ref:n})}),e(c,{label:t("type"),fieldId:"type",labelIcon:e(l,{helpText:"clients-help:type",fieldLabelId:"type"}),children:e(y,{id:"type",name:"type",ref:n})}),e(c,{label:t("uris"),fieldId:"uris",labelIcon:e(l,{helpText:"clients-help:uris",fieldLabelId:"clients:uris"}),children:e(ie,{name:"uris","aria-label":t("uris"),addButtonLabel:"clients:addUri"})}),e(pe,{clientId:a}),e(c,{label:t("iconUri"),fieldId:"iconUri",labelIcon:e(l,{helpText:"clients-help:iconUri",fieldLabelId:"clients:iconUri"}),children:e(y,{id:"iconUri",name:"icon_uri",ref:n})}),e(c,{hasNoPaddingTop:!0,label:t("ownerManagedAccess"),labelIcon:e(l,{helpText:"clients-help:ownerManagedAccess",fieldLabelId:"clients:ownerManagedAccess"}),fieldId:"ownerManagedAccess",children:e(K,{name:"ownerManagedAccess",control:u,defaultValue:!1,render:({onChange:r,value:p})=>e(J,{id:"ownerManagedAccess",label:t("common:on"),labelOff:t("common:off"),isChecked:p,onChange:r,"aria-label":t("ownerManagedAccess")})})}),e(c,{hasNoPaddingTop:!0,label:t("resourceAttribute"),labelIcon:e(l,{helpText:"clients-help:resourceAttribute",fieldLabelId:"clients:resourceAttribute"}),fieldId:"resourceAttribute",children:e(ue,{name:"attributes"})}),e(le,{children:w("div",{className:"pf-u-mt-md",children:[e(M,{variant:Q.primary,type:"submit","data-testid":"save",children:t("common:save")}),e(M,{variant:"link","data-testid":"cancel",component:r=>e(X,{...r,to:D({realm:F,clientId:a,tab:"resources"})}),children:t("common:cancel")})]})})]})})})]}):e(G,{})}export{Ve as default};
