"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[90],{90:(e,t,n)=>{n.r(t),n.d(t,{default:()=>G}),n(5623);var a=n(5863),l=n(2954),r=n(3802),i=n(1576),o=n(710),s=n(4839),d=n(3328),c=n(1677),m=n(3172),p=n(8798),u=n(1524),f=n(7203),P=n(5276),g=n(386);const y=({field:e,label:t,defaultValue:n})=>{const{t:l}=(0,r.$G)("identity-providers"),{control:s}=(0,i.Gc)(),{adminClient:d}=(0,p.K3)(),[c,m]=(0,a.eJ)(),[u,f]=(0,a.eJ)(!1);return(0,p.ib)((()=>d.authenticationManagement.getFlows()),(e=>m(e.filter((e=>"basic-flow"===e.providerId)))),[]),a.ZP.createElement(o.cw,{label:l(t),labelIcon:a.ZP.createElement(g.B,{helpText:`identity-providers-help:${t}`,fieldLabelId:`identity-providers:${t}`}),fieldId:t},a.ZP.createElement(i.Qr,{name:e,defaultValue:n,control:s,render:({onChange:e,value:r})=>a.ZP.createElement(o.Ph,{toggleId:t,required:!0,onToggle:()=>f(!u),onSelect:(t,n)=>{e(n),f(!1)},selections:r||l("common:none"),variant:o.TM.single,"aria-label":l(t),isOpen:u},a.ZP.createElement(a.ZP.Fragment,null,""===n&&a.ZP.createElement(o.$m,{key:"empty",value:n},l("common:none"))),a.ZP.createElement(a.ZP.Fragment,null,c?.map((e=>a.ZP.createElement(o.$m,{selected:e.alias===r,key:e.id,value:e.alias},e.alias)))))}))},E=["import","legacy","force"],Z=({isOIDC:e,isSAML:t})=>{const{t:n}=(0,r.$G)("identity-providers"),{control:l}=(0,i.Gc)(),[s,d]=(0,a.eJ)(!1);return a.ZP.createElement(a.ZP.Fragment,null,!e&&!t&&a.ZP.createElement(P.n,{field:"config.defaultScope",label:"scopes"}),a.ZP.createElement(f.K,{field:"storeToken",label:"storeTokens",fieldType:"boolean"}),(t||e)&&a.ZP.createElement(f.K,{field:"addReadTokenRoleOnCreate",label:"storedTokensReadable",fieldType:"boolean"}),!e&&!t&&a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(f.K,{field:"config.acceptsPromptNoneForwardFromClient",label:"acceptsPromptNone"}),a.ZP.createElement(f.K,{field:"config.disableUserInfo",label:"disableUserInfo"})),a.ZP.createElement(f.K,{field:"trustEmail",label:"trustEmail",fieldType:"boolean"}),a.ZP.createElement(f.K,{field:"linkOnly",label:"accountLinkingOnly",fieldType:"boolean"}),a.ZP.createElement(f.K,{field:"config.hideOnLoginPage",label:"hideOnLoginPage"}),a.ZP.createElement(y,{field:"firstBrokerLoginFlowAlias",label:"firstBrokerLoginFlowAlias",defaultValue:"fist broker login"}),a.ZP.createElement(y,{field:"postBrokerLoginFlowAlias",label:"postBrokerLoginFlowAlias",defaultValue:""}),a.ZP.createElement(o.cw,{label:n("syncMode"),labelIcon:a.ZP.createElement(g.B,{helpText:"identity-providers-help:syncMode",fieldLabelId:"identity-providers:syncMode"}),fieldId:"syncMode"},a.ZP.createElement(i.Qr,{name:"config.syncMode",defaultValue:E[0].toUpperCase(),control:l,render:({onChange:e,value:t})=>a.ZP.createElement(o.Ph,{toggleId:"syncMode",required:!0,direction:"up",onToggle:()=>d(!s),onSelect:(t,n)=>{e(n),d(!1)},selections:n(`syncModes.${t.toLowerCase()}`),variant:o.TM.single,"aria-label":n("syncMode"),isOpen:s},E.map((e=>a.ZP.createElement(o.$m,{selected:e===t,key:e,value:e.toUpperCase()},n(`syncModes.${e}`)))))})))};var v=n(9766),b=n(4326),C=n(764),h=n(2265),k=n(874);const I=["unspecified","none","consent","login","select_account"],x=()=>{const{t:e}=(0,r.$G)("identity-providers"),{control:t}=(0,i.Gc)(),[n,l]=(0,a.eJ)(!1),[s,d]=(0,a.eJ)(!1);return a.ZP.createElement(o.Lm,{toggleText:e("advanced"),onToggle:()=>l(!n),isExpanded:n},a.ZP.createElement(o.l0,{isHorizontal:!0},a.ZP.createElement(f.K,{label:"passLoginHint",field:"config.loginHint"}),a.ZP.createElement(f.K,{label:"passCurrentLocale",field:"config.uiLocales"}),a.ZP.createElement(f.K,{field:"config.backchannelSupported",label:"backchannelLogout"}),a.ZP.createElement(f.K,{field:"config.disableUserInfo",label:"disableUserInfo"}),a.ZP.createElement(P.n,{field:"config.defaultScope",label:"scopes"}),a.ZP.createElement(k.R,{label:"prompt"},a.ZP.createElement(i.Qr,{name:"config.prompt",defaultValue:I[0],control:t,render:({onChange:t,value:n})=>a.ZP.createElement(o.Ph,{toggleId:"prompt",required:!0,onToggle:()=>d(!s),onSelect:(e,n)=>{t(n),d(!1)},selections:n,variant:o.TM.single,"aria-label":e("prompt"),isOpen:s},I.map((t=>a.ZP.createElement(o.$m,{selected:t===n,key:t,value:t},e(`prompts.${t}`)))))})),a.ZP.createElement(f.K,{field:"config.acceptsPromptNoneForwardFromClient",label:"acceptsPromptNone"}),a.ZP.createElement(o.cw,{label:e("allowedClockSkew"),labelIcon:a.ZP.createElement(g.B,{helpText:"identity-providers-help:allowedClockSkew",fieldLabelId:"identity-providers:allowedClockSkew"}),fieldId:"allowedClockSkew"},a.ZP.createElement(i.Qr,{name:"config.allowedClockSkew",control:t,defaultValue:0,render:({onChange:t,value:n})=>a.ZP.createElement(o.Y2,{value:n,"data-testid":"allowedClockSkew",onMinus:()=>t(n-1),onChange:t,onPlus:()=>t(n+1),inputName:"input",inputAriaLabel:e("allowedClockSkew"),minusBtnAriaLabel:e("common:minus"),plusBtnAriaLabel:e("common:plus"),min:0,unit:e("common:times.seconds")})})),a.ZP.createElement(P.n,{field:"config.forwardParameters",label:"forwardParameters"})))};var w=n(8051),K=n(8997),L=n(8790),R=n(4615),S=n(4403),T=n(5212);const M=["exact","minimum","maximum","better"],O=()=>{const{t:e}=(0,r.$G)("identity-providers"),{control:t}=(0,i.Gc)(),[n,l]=(0,a.eJ)(!1);return a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(o.cw,{label:e("comparison"),labelIcon:a.ZP.createElement(g.B,{helpText:"identity-providers-help:comparison",fieldLabelId:"identity-providers:comparison"}),fieldId:"comparison"},a.ZP.createElement(i.Qr,{name:"config.authnContextComparisonType",defaultValue:M[0],control:t,render:({onChange:t,value:r})=>a.ZP.createElement(o.Ph,{toggleId:"comparison",required:!0,direction:"up",onToggle:e=>l(e),onSelect:(e,n)=>{t(n.toString()),l(!1)},selections:r,variant:o.TM.single,"aria-label":e("comparison"),isOpen:n},M.map((t=>a.ZP.createElement(o.$m,{selected:t===r,key:t,value:t},e(t)))))})),a.ZP.createElement(o.cw,{label:e("authnContextClassRefs"),fieldId:"kc-authnContextClassRefs",labelIcon:a.ZP.createElement(g.B,{helpText:"identity-providers-help:authnContextClassRefs",fieldLabelId:"authnContextClassRefs"})},a.ZP.createElement(T.B,{name:"config.authnContextClassRefs","aria-label":e("identify-providers:authnContextClassRefs"),addButtonLabel:"identity-providers:addAuthnContextClassRef","data-testid":"classref-field"})),a.ZP.createElement(o.cw,{label:e("authnContextDeclRefs"),fieldId:"kc-authnContextDeclRefs",labelIcon:a.ZP.createElement(g.B,{helpText:"identity-providers-help:authnContextDeclRefs",fieldLabelId:"authnContextDeclRefs"})},a.ZP.createElement(T.B,{name:"config.authnContextDeclRefs","aria-label":e("identify-providers:authnContextDeclRefs"),addButtonLabel:"identity-providers:addAuthnContextDeclRef","data-testid":"declref-field"})))};var B=n(192),D=n(1586),F=n(7959),N=n(8802),A=n(5012),V=n(8336),$=n(5309),J=n(860);const U=({onChange:e,value:t,save:n,toggleDeleteDialog:s})=>{const{t:d}=(0,r.$G)("identity-providers"),{alias:m}=(0,l.UO)(),{control:p}=(0,i.Gc)(),u=(0,i.qo)({name:"displayName",control:p,defaultValue:m}),[f,P]=(0,v.W)({titleKey:"identity-providers:disableProvider",messageKey:d("disableConfirm",{provider:u}),continueButtonLabel:"common:disable",onConfirm:()=>{e(!t),n()}});return a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(P,null),a.ZP.createElement(c.t,{titleKey:(0,V.LO)(u),divider:!1,dropdownItems:[a.ZP.createElement(o.hP,{key:"delete",onClick:()=>s()},d("common:delete"))],isEnabled:t,onToggle:t=>{t?(e(t),n()):f()}}))};function G(){const{t:e}=(0,r.$G)("identity-providers"),{alias:t,providerId:n}=(0,l.UO)(),c=(0,i.cI)(),{handleSubmit:f,getValues:P,reset:g}=c,[y,E]=(0,a.eJ)(),[k,I]=(0,a.eJ)(),{adminClient:T}=(0,p.K3)(),{addAlert:M,addError:V}=(0,b.Z7)(),G=(0,l.k6)(),{realm:H}=(0,C.PL)(),[z,q]=(0,a.eJ)(0);(0,p.ib)((()=>T.identityProviders.findOne({alias:t})),(t=>{if(!t)throw new Error(e("common:notFound"));g(t),E(t),t.config.authnContextClassRefs&&c.setValue("config.authnContextClassRefs",JSON.parse(t.config?.authnContextClassRefs)),t.config.authnContextDeclRefs&&c.setValue("config.authnContextDeclRefs",JSON.parse(t.config?.authnContextDeclRefs))}),[]);const Q=async a=>{const l=a||P();l.config?.authnContextClassRefs&&(l.config.authnContextClassRefs=JSON.stringify(l.config.authnContextClassRefs)),l.config?.authnContextDeclRefs&&(l.config.authnContextDeclRefs=JSON.stringify(l.config.authnContextDeclRefs));try{await T.identityProviders.update({alias:t},{...l,alias:t,providerId:n}),M(e("updateSuccess"),o.Ux.success)}catch(e){V("identity-providers:updateError",e)}},[W,_]=(0,v.W)({titleKey:"identity-providers:deleteProvider",messageKey:e("identity-providers:deleteConfirm",{provider:t}),continueButtonLabel:"common:delete",continueButtonVariant:o.Wu.danger,onConfirm:async()=>{try{await T.identityProviders.del({alias:t}),M(e("deletedSuccess"),o.Ux.success),G.push((0,A.A)({realm:H}))}catch(e){V("identity-providers:deleteErrorError",e)}}}),[j,Y]=(0,v.W)({titleKey:"identity-providers:deleteProviderMapper",messageKey:e("identity-providers:deleteMapperConfirm",{mapper:k?.name}),continueButtonLabel:"common:delete",continueButtonVariant:o.Wu.danger,onConfirm:async()=>{try{await T.identityProviders.delMapper({alias:t,id:k?.mapperId}),M(e("deleteMapperSuccess"),o.Ux.success),q(z+1),G.push((0,$.Q)({providerId:n,alias:t,tab:"mappers",realm:H}))}catch(e){V("identity-providers:deleteErrorError",e)}}});if(!y)return a.ZP.createElement(m.g,null);const X=y.providerId.includes("oidc"),ee=y.providerId.includes("saml"),te=[{title:e("generalSettings"),panel:a.ZP.createElement(s.N,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:f(Q)},!X&&!ee&&a.ZP.createElement(u.q,{create:!1,id:t}),X&&a.ZP.createElement(L.h,{id:t}),ee&&a.ZP.createElement(R.D,{id:t}))},{title:e("oidcSettings"),isHidden:!X,panel:a.ZP.createElement(a.ZP.Fragment,null,a.ZP.createElement(w.Y,{readOnly:!1}),a.ZP.createElement(o.l0,{isHorizontal:!0,className:"pf-u-py-lg"},a.ZP.createElement(o.iz,null),a.ZP.createElement(S.Z,{create:!1})),a.ZP.createElement(x,null))},{title:e("samlSettings"),isHidden:!ee,panel:a.ZP.createElement(K.X,{readOnly:!1})},{title:e("reqAuthnConstraints"),isHidden:!ee,panel:a.ZP.createElement(s.N,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:f(Q)},a.ZP.createElement(O,null))},{title:e("advancedSettings"),panel:a.ZP.createElement(s.N,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:f(Q)},a.ZP.createElement(Z,{isOIDC:X,isSAML:ee}),a.ZP.createElement(o.WK,{className:"keycloak__form_actions"},a.ZP.createElement(o.zx,{"data-testid":"save",type:"submit"},e("common:save")),a.ZP.createElement(o.zx,{"data-testid":"revert",variant:"link",onClick:()=>{g()}},e("common:revert"))))}];return a.ZP.createElement(i.RV,{...c},a.ZP.createElement(_,null),a.ZP.createElement(Y,null),a.ZP.createElement(i.Qr,{name:"enabled",control:c.control,defaultValue:!0,render:({onChange:e,value:t})=>a.ZP.createElement(U,{value:t,onChange:e,save:Q,toggleDeleteDialog:W})}),a.ZP.createElement(o.NP,{variant:"light",className:"pf-u-p-0"},a.ZP.createElement(h.n,{isBox:!0},a.ZP.createElement(o.OK,{id:"settings",eventKey:"settings",title:a.ZP.createElement(o.TP,null,e("common:settings"))},a.ZP.createElement(d.W,{className:"pf-u-px-lg",sections:te})),a.ZP.createElement(o.OK,{id:"mappers","data-testid":"mappers-tab",eventKey:"mappers",title:a.ZP.createElement(o.TP,null,e("common:mappers"))},a.ZP.createElement(B.B,{emptyState:a.ZP.createElement(D.M,{message:e("identity-providers:noMappers"),instructions:e("identity-providers:noMappersInstructions"),primaryActionText:e("identity-providers:addMapper"),onPrimaryAction:()=>G.push((0,F.j)({realm:H,alias:t,providerId:y.providerId,tab:"mappers"}))}),loader:async()=>{const[e,n]=await Promise.all([T.identityProviders.findMappers({alias:t}),T.identityProviders.findMapperTypes({alias:t})]);return e.map((e=>{const t=Object.values(n).find((t=>e.identityProviderMapper===t.id));return{...t,name:e.name,type:t?.name,mapperId:e.id}}))},key:z,ariaLabelKey:"identity-providers:mappersList",searchPlaceholderKey:"identity-providers:searchForMapper",toolbarItem:a.ZP.createElement(o.Eg,null,a.ZP.createElement(o.zx,{id:"add-mapper-button",component:e=>a.ZP.createElement(l.rU,{...e,to:(0,F.j)({realm:H,alias:t,providerId:y.providerId,tab:"mappers"})}),"data-testid":"addMapper"},e("addMapper"))),columns:[{name:"name",displayKey:"common:name",cellRenderer:({name:e,mapperId:n})=>a.ZP.createElement(l.rU,{to:(0,N.n)({realm:H,alias:t,providerId:y?.providerId,id:n})},e)},{name:"category",displayKey:"common:category"},{name:"type",displayKey:"common:type"}],actions:[{title:e("common:delete"),onRowClick:e=>{I(e),j()}}]})),a.ZP.createElement(o.OK,{id:"permissions","data-testid":"permissionsTab",eventKey:"permissions",title:a.ZP.createElement(o.TP,null,e("common:permissions"))},a.ZP.createElement(J.y,{id:t,type:"identityProviders"})))))}}}]);