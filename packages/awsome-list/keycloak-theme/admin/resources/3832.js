"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3832],{3832:(e,t,a)=>{a.r(t),a.d(t,{default:()=>B}),a(5623);var r=a(710),n=a(7973),l=a(2688),s=a(390),c=a(5863),o=a(1576),i=a(3802),m=a(2954),d=a(1586),p=a(192),u=a(1677),y=a(1786),P=a(8798),E=a(764),h=a(4607),_=a(4467),f=a(2655),Z=a(1639),k=a(9280),v=a(8336),T=a(3413),g=a(9623),b=a(7092),C=a(7525),I=a(370);const F=({text:e,children:t})=>{const a=e||"",n=a.length>38,l=a.substring(0,38);return n?c.ZP.createElement(r.u,{content:e},t(l+"â€¦")):t(a)},N=new RegExp(/([0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12})/),A=(e,t)=>{const a=N.exec(t.resourcePath);if(!a)return console.warn("event didn't contain a valid link",t),"";const r=a[1];return"CLIENT"===t.resourceType||t.resourceType?.startsWith("AUTHORIZATION_RESOURCE")?(0,T.O)({realm:e,clientId:r,tab:"CLIENT"===t.resourceType?"settings":"authorization"}):"GROUP"===t.resourceType?(0,g.J)({realm:e,id:r}):"CLIENT_SCOPE"===t.resourceType?(0,b.w)({realm:e,id:r,tab:"settings"}):"USER"===t.resourceType||"GROUP_MEMBERSHIP"===t.resourceType?(0,_.Z)({realm:e,id:r,tab:"settings"}):"AUTH_FLOW"===t.resourceType?(0,I.s)({realm:e,id:r,usedBy:"-"}):t.resourcePath?.startsWith("roles-by-id")?(0,C.D)({realm:e,id:r}):""},x=({event:e})=>{const{realm:t}=(0,E.PL)();return c.ZP.createElement(F,{text:e.resourcePath},(a=>(e=>"DELETE"!==e.operationType&&("USER"===e.resourceType||"GROUP_MEMBERSHIP"===e.resourceType||"GROUP"===e.resourceType||"CLIENT"===e.resourceType||e.resourceType?.startsWith("AUTHORIZATION_RESOURCE")||"CLIENT_SCOPE"===e.resourceType||"AUTH_FLOW"===e.resourceType||e.resourcePath?.startsWith("roles-by-id")))(e)?c.ZP.createElement(m.rU,{to:A(t,e)},a):c.ZP.createElement("span",null,a)))},R=e=>c.ZP.createElement(x,{event:e}),O={resourceTypes:[],operationTypes:[],resourcePath:"",dateFrom:"",dateTo:"",authClient:"",authUser:"",authRealm:"",authIpAddress:""},S=({titleKey:e,onClose:t,children:a})=>{const{t:n}=(0,i.$G)("events");return c.ZP.createElement(r.u_,{variant:r.vE.medium,title:n(e),isOpen:!0,onClose:t},a)},w=()=>{const{t:e}=(0,i.$G)("events"),{adminClient:t}=(0,P.K3)(),{realm:a}=(0,E.PL)(),n=(0,k.tN)(),m=(0,f.Z)(),u=n.enums?.resourceType,h=n.enums?.operationType,[_,T]=(0,c.eJ)(0),[g,b]=(0,c.eJ)(!1),[C,I]=(0,c.eJ)(!1),[F,N]=(0,c.eJ)(!1),[A,x]=(0,c.eJ)({}),[w,U]=(0,c.eJ)(),[K,M]=(0,c.eJ)(),D={resourceTypes:e("resourceTypes"),operationTypes:e("operationTypes"),resourcePath:e("resourcePath"),dateFrom:e("dateFrom"),dateTo:e("dateTo"),authClient:e("client"),authUser:e("userId"),authRealm:e("realm"),authIpAddress:e("ipAddress")},{getValues:L,register:J,reset:B,formState:{isDirty:G},control:z}=(0,o.cI)({shouldUnregister:!1,mode:"onChange",defaultValues:O});function H(){const e=(0,s.D9)(L(),(e=>""!==e||Array.isArray(e)&&e.length>0));x(e),T(_+1)}const W=[[e("realm"),w?.authDetails?.realmId],[e("client"),w?.authDetails?.clientId],[e("user"),w?.authDetails?.userId],[e("ipAddress"),w?.authDetails?.ipAddress]],j=(0,c.Ye)((()=>K?.representation?(0,v.tR)(JSON.parse(K.representation)):""),[K?.representation]);return c.ZP.createElement(c.ZP.Fragment,null,w&&c.ZP.createElement(S,{titleKey:"auth",onClose:()=>U(void 0)},c.ZP.createElement(l.iA,{"aria-label":"authData","data-testid":"auth-dialog",variant:l.BZ.compact,cells:[e("attribute"),e("value")],rows:W},c.ZP.createElement(l.xD,null),c.ZP.createElement(l.RM,null))),K&&c.ZP.createElement(S,{titleKey:"representation","data-testid":"representation-dialog",onClose:()=>M(void 0)},c.ZP.createElement(Z.p,{isLineNumbersVisible:!0,isReadOnly:!0,code:j,language:Z.S.json,height:"8rem"})),c.ZP.createElement(p.B,{key:_,loader:function(e,r){return t.realms.findAdminEvents({...A,realm:a,first:e,max:r})},isPaginated:!0,ariaLabelKey:"events:adminEvents",toolbarItem:c.ZP.createElement(r.kC,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},c.ZP.createElement(r.B5,null,c.ZP.createElement(r.Lt,{id:"admin-events-search-select","data-testid":"AdminEventsSearchSelector",className:"pf-u-ml-md",toggle:c.ZP.createElement(r.Z_,{"data-testid":"adminEventsSearchSelectorToggle",onToggle:e=>b(e),className:"keycloak__events_search_selector_dropdown__toggle"},e("searchForAdminEvent")),isOpen:g},c.ZP.createElement(r.l0,{isHorizontal:!0,className:"keycloak__events_search__form","data-testid":"searchForm"},c.ZP.createElement(r.cw,{label:e("resourceTypes"),fieldId:"kc-resourceTypes",className:"keycloak__events_search__form_label"},c.ZP.createElement(o.Qr,{name:"resourceTypes",control:z,render:({onChange:t,value:a})=>c.ZP.createElement(r.Ph,{className:"keycloak__events_search__type_select",name:"resourceTypes","data-testid":"resource-types-searchField",chipGroupProps:{numChips:1,expandedText:e("common:hide"),collapsedText:e("common:showRemaining")},variant:r.TM.typeaheadMulti,typeAheadAriaLabel:"Select",onToggle:e=>I(e),selections:a,onSelect:(e,r)=>{const n=r.toString(),l=a.includes(n)?a.filter((e=>e!==n)):[...a,n];t(l)},onClear:e=>{e.stopPropagation(),t([])},isOpen:C,"aria-labelledby":"resourceTypes",chipGroupComponent:c.ZP.createElement(r.Zn,null,a.map((e=>c.ZP.createElement(r.Af,{key:e,onClick:r=>{r.stopPropagation(),t(a.filter((t=>t!==e)))}},e))))},u?.map((e=>c.ZP.createElement(r.$m,{key:e,value:e}))))})),c.ZP.createElement(r.cw,{label:e("operationTypes"),fieldId:"kc-operationTypes",className:"keycloak__events_search__form_label"},c.ZP.createElement(o.Qr,{name:"operationTypes",control:z,render:({onChange:t,value:a})=>c.ZP.createElement(r.Ph,{className:"keycloak__events_search__type_select",name:"operationTypes","data-testid":"operation-types-searchField",chipGroupProps:{numChips:1,expandedText:e("common:hide"),collapsedText:e("common:showRemaining")},variant:r.TM.typeaheadMulti,typeAheadAriaLabel:"Select",onToggle:e=>N(e),selections:a,onSelect:(e,r)=>{const n=r.toString(),l=a.includes(n)?a.filter((e=>e!==n)):[...a,n];t(l)},onClear:e=>{e.stopPropagation(),t([])},isOpen:F,"aria-labelledby":"operationTypes",chipGroupComponent:c.ZP.createElement(r.Zn,null,a.map((e=>c.ZP.createElement(r.Af,{key:e,onClick:r=>{r.stopPropagation(),t(a.filter((t=>t!==e)))}},e))))},h?.map((e=>c.ZP.createElement(r.$m,{key:e,value:e}))))})),c.ZP.createElement(r.cw,{label:e("resourcePath"),fieldId:"kc-resourcePath",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-resourcePath",name:"resourcePath","data-testid":"resourcePath-searchField"})),c.ZP.createElement(r.cw,{label:e("realm"),fieldId:"kc-realm",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-realm",name:"authRealm","data-testid":"realm-searchField"})),c.ZP.createElement(r.cw,{label:e("client"),fieldId:"kc-client",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-client",name:"authClient","data-testid":"client-searchField"})),c.ZP.createElement(r.cw,{label:e("user"),fieldId:"kc-user",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-user",name:"authUser","data-testid":"user-searchField"})),c.ZP.createElement(r.cw,{label:e("ipAddress"),fieldId:"kc-ipAddress",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-ipAddress",name:"authIpAddress","data-testid":"ipAddress-searchField"})),c.ZP.createElement(r.cw,{label:e("dateFrom"),fieldId:"kc-dateFrom",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-dateFrom",name:"dateFrom",className:"pf-c-form-control pf-m-icon pf-m-calendar",placeholder:"yyyy-MM-dd","data-testid":"dateFrom-searchField"})),c.ZP.createElement(r.cw,{label:e("dateTo"),fieldId:"kc-dateTo",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:J(),type:"text",id:"kc-dateTo",name:"dateTo",className:"pf-c-form-control pf-m-icon pf-m-calendar",placeholder:"yyyy-MM-dd","data-testid":"dateTo-searchField"})),c.ZP.createElement(r.WK,null,c.ZP.createElement(r.zx,{variant:"primary",onClick:function(){b(!1),H()},"data-testid":"search-events-btn",isDisabled:!G},e("searchAdminEventsBtn")),c.ZP.createElement(r.zx,{variant:"secondary",onClick:function(){B(),H()},isDisabled:!G},e("resetBtn"))))),c.ZP.createElement(r.zx,{className:"pf-u-ml-md",onClick:function(){H()},"data-testid":"refresh-btn"},e("refresh"))),c.ZP.createElement(r.B5,null,Object.entries(A).length>0&&c.ZP.createElement("div",{className:"keycloak__searchChips pf-u-ml-md"},Object.entries(A).map((e=>{const[t,a]=e;return c.ZP.createElement(r.Zn,{className:"pf-u-mt-md pf-u-mr-md",key:t,categoryName:D[t],isClosable:!0,onClick:()=>function(e){const t={...L()};delete t[e],B({...O,...t}),H()}(t)},"string"==typeof a?c.ZP.createElement(r.Af,{isReadOnly:!0},a):a.map((e=>c.ZP.createElement(r.Af,{key:e,onClick:()=>function(e,t){const a=L(),r=a[e],n=Array.isArray(r)?r.filter((e=>e!==t)):r;B({...a,[e]:n}),H()}(t,e)},e))))}))))),actions:[{title:e("auth"),onRowClick:e=>U(e)},{title:e("representation"),onRowClick:e=>M(e)}],columns:[{name:"time",displayKey:"events:time",cellRenderer:e=>m(new Date(e.time),f.t)},{name:"resourcePath",displayKey:"events:resourcePath",cellRenderer:R},{name:"resourceType",displayKey:"events:resourceType"},{name:"operationType",displayKey:"events:operationType",transforms:[(0,l.dY)(10)]},{name:"",displayKey:"events:user",cellRenderer:e=>e.authDetails?.userId}],emptyState:c.ZP.createElement(d.M,{message:e("emptyEvents"),instructions:e("emptyEventsInstructions")}),isSearching:Object.keys(A).length>0}))};var U=a(9176),K=a(7482),M=a(7246);const D={client:"",dateFrom:"",dateTo:"",user:"",type:[]},L=e=>e.error?c.ZP.createElement(r.u,{content:e.error},c.ZP.createElement("span",null,c.ZP.createElement(n.T6,{color:"orange"})," ",e.type)):c.ZP.createElement("span",null,c.ZP.createElement(n.rE,{color:"green"})," ",e.type),J=e=>c.ZP.createElement(r.o6,{isHorizontal:!0,className:"keycloak_eventsection_details"},Object.entries(e.details).map((([e,t])=>c.ZP.createElement(r.gy,{key:e},c.ZP.createElement(r.MU,null,e),c.ZP.createElement(r.bP,null,t)))));function B(){const{t:e}=(0,i.$G)("events"),{adminClient:t}=(0,P.K3)(),{realm:a}=(0,E.PL)(),n=(0,f.Z)(),[Z,k]=(0,c.eJ)(0),[v,T]=(0,c.eJ)(!1),[g,b]=(0,c.eJ)(!1),[C,I]=(0,c.eJ)(),[F,N]=(0,c.eJ)({}),A={client:e("client"),dateFrom:e("dateFrom"),dateTo:e("dateTo"),user:e("userId"),type:e("eventType")},{getValues:x,register:R,reset:O,formState:{isDirty:S},control:B}=(0,o.cI)({shouldUnregister:!1,mode:"onChange",defaultValues:D});function G(){const e=(0,s.D9)(x(),(e=>""!==e||Array.isArray(e)&&e.length>0));N(e),k(Z+1)}(0,P.ib)((()=>t.realms.getConfigEvents({realm:a})),(e=>I(e)),[]);const z=(0,m.k6)(),H=e=>(0,K.w)({to:(0,M.J)({realm:a,tab:e}),history:z});return c.ZP.createElement(c.ZP.Fragment,null,c.ZP.createElement(u.t,{titleKey:"events:title",subKey:c.ZP.createElement(i.cC,{i18nKey:"events:eventExplain"},"If you want to configure user events, Admin events or Event listeners, please enter",c.ZP.createElement(m.rU,{to:(0,h.Q)({realm:a,tab:"events"})},e("eventConfig")),"page realm settings to configure."),helpUrl:U.Z.eventsUrl,divider:!1}),c.ZP.createElement(r.NP,{variant:"light",className:"pf-u-p-0"},c.ZP.createElement(K.U,{isBox:!0,defaultLocation:(0,M.J)({realm:a,tab:"user-events"})},c.ZP.createElement(r.OK,{title:c.ZP.createElement(r.TP,null,e("userEvents")),...H("user-events")},c.ZP.createElement("div",{className:"keycloak__events_table"},c.ZP.createElement(p.B,{key:Z,loader:function(e,r){return t.realms.findEvents({...F,realm:a,first:e,max:r})},detailColumns:[{name:"details",enabled:e=>void 0!==e.details,cellRenderer:J}],isPaginated:!0,ariaLabelKey:"events:title",toolbarItem:c.ZP.createElement(r.kC,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},c.ZP.createElement(r.B5,null,c.ZP.createElement(r.Lt,{id:"user-events-search-select","data-testid":"UserEventsSearchSelector",className:"pf-u-ml-md",toggle:c.ZP.createElement(r.Z_,{"data-testid":"userEventsSearchSelectorToggle",onToggle:e=>T(e),className:"keycloak__events_search_selector_dropdown__toggle"},e("searchForUserEvent")),isOpen:v},c.ZP.createElement(r.l0,{isHorizontal:!0,className:"keycloak__events_search__form","data-testid":"searchForm"},c.ZP.createElement(r.cw,{label:e("userId"),fieldId:"kc-userId",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:R(),type:"text",id:"kc-userId",name:"user","data-testid":"userId-searchField"})),c.ZP.createElement(r.cw,{label:e("eventType"),fieldId:"kc-eventType",className:"keycloak__events_search__form_label"},c.ZP.createElement(o.Qr,{name:"type",control:B,render:({onChange:t,value:a})=>c.ZP.createElement(r.Ph,{className:"keycloak__events_search__type_select",name:"eventType","data-testid":"event-type-searchField",chipGroupProps:{numChips:1,expandedText:e("common:hide"),collapsedText:e("common:showRemaining")},variant:r.TM.typeaheadMulti,typeAheadAriaLabel:"Select",onToggle:e=>b(e),selections:a,onSelect:(e,r)=>{const n=r.toString(),l=a.includes(n)?a.filter((e=>e!==n)):[...a,n];t(l)},onClear:e=>{e.stopPropagation(),t([])},isOpen:g,"aria-labelledby":"eventType",chipGroupComponent:c.ZP.createElement(r.Zn,null,a.map((e=>c.ZP.createElement(r.Af,{key:e,onClick:r=>{r.stopPropagation(),t(a.filter((t=>t!==e)))}},e))))},C?.enabledEventTypes?.map((e=>c.ZP.createElement(r.$m,{key:e,value:e}))))})),c.ZP.createElement(r.cw,{label:e("client"),fieldId:"kc-client",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:R(),type:"text",id:"kc-client",name:"client","data-testid":"client-searchField"})),c.ZP.createElement(r.cw,{label:e("dateFrom"),fieldId:"kc-dateFrom",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:R(),type:"text",id:"kc-dateFrom",name:"dateFrom",className:"pf-c-form-control pf-m-icon pf-m-calendar",placeholder:"yyyy-MM-dd","data-testid":"dateFrom-searchField"})),c.ZP.createElement(r.cw,{label:e("dateTo"),fieldId:"kc-dateTo",className:"keycloak__events_search__form_label"},c.ZP.createElement(y.F,{ref:R(),type:"text",id:"kc-dateTo",name:"dateTo",className:"pf-c-form-control pf-m-icon pf-m-calendar",placeholder:"yyyy-MM-dd","data-testid":"dateTo-searchField"})),c.ZP.createElement(r.WK,null,c.ZP.createElement(r.zx,{variant:"primary",onClick:function(){T(!1),G()},"data-testid":"search-events-btn",isDisabled:!S},e("searchUserEventsBtn")),c.ZP.createElement(r.zx,{variant:"secondary",onClick:function(){O(),G()},isDisabled:!S},e("resetBtn"))))),c.ZP.createElement(r.zx,{className:"pf-u-ml-md",onClick:function(){G()},"data-testid":"refresh-btn"},e("refresh"))),c.ZP.createElement(r.B5,null,Object.entries(F).length>0&&c.ZP.createElement("div",{className:"keycloak__searchChips pf-u-ml-md"},Object.entries(F).map((e=>{const[t,a]=e;return c.ZP.createElement(r.Zn,{className:"pf-u-mt-md pf-u-mr-md",key:t,categoryName:A[t],isClosable:!0,onClick:()=>function(e){const t={...x()};delete t[e],O({...D,...t}),G()}(t)},"string"==typeof a?c.ZP.createElement(r.Af,{isReadOnly:!0},a):a.map((e=>c.ZP.createElement(r.Af,{key:e,onClick:()=>function(e,t){const a=x(),r=a[e],n=Array.isArray(r)?r.filter((e=>e!==t)):r;O({...a,[e]:n}),G()}(t,e)},e))))}))))),columns:[{name:"time",displayKey:"events:time",cellFormatters:[l.zW],cellRenderer:e=>n(new Date(e.time),f.t)},{name:"userId",displayKey:"events:user",cellRenderer:t=>c.ZP.createElement(c.ZP.Fragment,null,t.userId&&c.ZP.createElement(m.rU,{key:`link-${t.time}-${t.type}`,to:(0,_.Z)({realm:a,id:t.userId,tab:"settings"})},t.userId),!t.userId&&e("noUserDetails"))},{name:"type",displayKey:"events:eventType",cellRenderer:L},{name:"ipAddress",displayKey:"events:ipAddress",transforms:[(0,l.dY)(10)]},{name:"clientId",displayKey:"events:client"}],emptyState:c.ZP.createElement(d.M,{message:e("emptyEvents"),instructions:e("emptyEventsInstructions")}),isSearching:Object.keys(F).length>0}))),c.ZP.createElement(r.OK,{title:c.ZP.createElement(r.TP,null,e("adminEvents")),"data-testid":"admin-events-tab",...H("admin-events")},c.ZP.createElement(w,null)))))}}}]);